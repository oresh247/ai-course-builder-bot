# Руководство по команде `/generate_topics`

## Описание

Команда `/generate_topics` генерирует **детальные учебные материалы** для каждого пункта плана содержания урока (`content_outline`). Это третий уровень детализации контента:

1. **Уровень 1**: Структура курса (модули и уроки) - создаётся через `/create`
2. **Уровень 2**: Лекции и слайды для модуля - создаются через `/generate`
3. **Уровень 3**: Детальные материалы по каждой теме урока - создаются через `/generate_topics` ⭐

## Как использовать

### Шаг 1: Создайте курс
```
/create
```
Следуйте инструкциям для создания структуры курса.

### Шаг 2: Убедитесь, что урок имеет план содержания

Каждый урок должен иметь поле `content_outline` (план содержания). Оно создаётся автоматически при создании курса или при использовании `/regenerate_lesson`.

Пример плана содержания:
- Установка Python: подробное руководство по установке Python на разных операционных системах
- Настройка рабочего окружения: установка и настройка IDE
- Установка и использование пакетного менеджера pip
- Создание виртуального окружения
- Установка и использование фреймворка Flask

### Шаг 3: Запустите генерацию детальных материалов
```
/generate_topics
```

Бот предложит:
1. Выбрать модуль
2. Выбрать урок из этого модуля
3. Запустить генерацию детальных материалов

## Что генерируется?

Для каждого пункта плана содержания (`content_outline`) AI создаёт:

### 1. Теоретические блоки (`theory_blocks`)
- Детальные объяснения концепций
- Несколько параграфов связного текста
- Педагогически структурированная подача материала

### 2. Примеры кода (`code_examples`)
- Реальные примеры кода
- Пояснения к каждому примеру
- Комментарии в коде

### 3. Практические упражнения (`practice_tasks`)
- Задачи для самостоятельной работы
- Разные уровни сложности
- Критерии оценки

### 4. Ключевые понятия (`key_concepts`)
- Термины и определения
- Важные концепции темы

### 5. Полезные ресурсы (`resources`)
- Ссылки на документацию
- Дополнительные материалы для изучения

## Структура данных

Сгенерированные материалы сохраняются в поле `detailed_content` урока:

```python
class TopicMaterial(BaseModel):
    topic_title: str                    # Название темы
    topic_description: str              # Описание темы
    theory_blocks: List[str]            # Блоки теории
    code_examples: List[Dict[str, str]] # Примеры кода
    practice_tasks: List[Dict[str, str]]# Практические задания
    key_concepts: List[str]             # Ключевые концепции
    resources: List[str]                # Полезные ресурсы

class LessonContent(BaseModel):
    lesson_title: str
    course_context: str
    module_context: str
    topic_materials: List[TopicMaterial]  # Материалы по каждой теме
```

## Пример использования

### Контекст
У вас есть урок "Установка и настройка окружения" с 5 пунктами в плане содержания.

### Команда
```
/generate_topics
```

### Результат
AI сгенерирует детальные учебные материалы для каждого из 5 пунктов:

**Тема 1: Установка Python**
- 3-5 блоков теории о том, как устанавливать Python
- Примеры команд для Windows, macOS, Linux
- Практические задания на проверку установки
- Ключевые понятия: PATH, версии Python, pip
- Ресурсы: ссылки на официальную документацию

**Тема 2: Настройка IDE**
- Теория о выборе и настройке IDE
- Примеры конфигурации PyCharm/VS Code
- Задания на настройку окружения
- И т.д.

## Время генерации

⏱️ **Важно**: Генерация детальных материалов может занять **несколько минут**, особенно для уроков с большим количеством тем в плане содержания.

Примерное время:
- 3-5 тем: ~2-3 минуты
- 6-8 тем: ~4-6 минут
- 9+ тем: может потребоваться 7+ минут

## Экспорт

После генерации вы можете экспортировать материалы (функция в разработке).

## Связь с другими командами

- `/create` → создаёт структуру курса с `content_outline`
- `/regenerate_lesson` → пересоздаёт урок с новым `content_outline`
- `/generate_topics` → генерирует детальные материалы по `content_outline` ⭐
- `/export` → экспортирует весь курс, включая детальные материалы

## Требования

- Урок должен иметь непустое поле `content_outline`
- Если урок не имеет плана содержания, бот предложит сначала использовать `/regenerate_lesson`

## Технические детали

- Используется модель GPT-4 для генерации
- Каждая тема генерируется отдельным запросом к AI
- Система использует многоуровневый fallback для обеспечения надёжности
- Материалы сохраняются в структуре курса и доступны для дальнейшего использования

## Подсказки

1. **Качество зависит от плана содержания**: Чем конкретнее пункты в `content_outline`, тем лучше будут сгенерированные материалы.

2. **Итеративная работа**: Если результат не устраивает, используйте `/regenerate_lesson` для обновления плана содержания, затем снова `/generate_topics`.

3. **Проверяйте результаты**: После генерации проверьте материалы через экспорт и при необходимости отредактируйте вручную.

## Известные ограничения

- Пока нет функции экспорта только детальных материалов (в планах)
- Нет возможности регенерировать отдельную тему (только весь урок целиком)
- Время генерации может быть значительным для уроков с большим планом содержания

## Будущие улучшения

- [ ] Экспорт детальных материалов в отдельные файлы
- [ ] Регенерация отдельной темы урока
- [ ] Настройка глубины детализации материалов
- [ ] Генерация визуальных схем и диаграмм
- [ ] Автоматическая проверка качества сгенерированных материалов

